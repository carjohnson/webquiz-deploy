{"version":3,"file":"modes_preclinical-4d_src_index_tsx.js","mappings":";;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7HA;AAEA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAIA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAEA;AAKA;AAKA;AAIA;AAQA;AAMA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AAGA;AACA;AACA;AAAA;AAAA;AACA;;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjNA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpKA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA","sources":["file:///D:%5CUsers%5Ccjohnson%5CGitRepositories%5COHIF-Viewer-Dev%5Cohif%5Cmodes%5Cpreclinical-4d%5Csrc%5CgetWorkflowSettings.ts","file:///D:%5CUsers%5Ccjohnson%5CGitRepositories%5COHIF-Viewer-Dev%5Cohif%5Cmodes%5Cpreclinical-4d%5Csrc%5Cid.js","file:///D:%5CUsers%5Ccjohnson%5CGitRepositories%5COHIF-Viewer-Dev%5Cohif%5Cmodes%5Cpreclinical-4d%5Csrc%5Cindex.tsx","file:///D:%5CUsers%5Ccjohnson%5CGitRepositories%5COHIF-Viewer-Dev%5Cohif%5Cmodes%5Cpreclinical-4d%5Csrc%5CinitToolGroups.tsx","file:///D:%5CUsers%5Ccjohnson%5CGitRepositories%5COHIF-Viewer-Dev%5Cohif%5Cmodes%5Cpreclinical-4d%5Csrc%5CinitWorkflowSteps.ts","file:///D:%5CUsers%5Ccjohnson%5CGitRepositories%5COHIF-Viewer-Dev%5Cohif%5Cmodes%5Cpreclinical-4d%5Csrc%5CtoolbarButtons.tsx"],"sourcesContent":["const dynamicVolume = {\r\n  sopClassHandler:\r\n    '@ohif/extension-cornerstone-dynamic-volume.sopClassHandlerModule.dynamic-volume',\r\n  leftPanel: '@ohif/extension-cornerstone-dynamic-volume.panelModule.dynamic-volume',\r\n  segmentation: '@ohif/extension-cornerstone-dynamic-volume.panelModule.dynamic-segmentation',\r\n};\r\n\r\nconst cornerstone = {\r\n  segmentation: '@ohif/extension-cornerstone.panelModule.panelSegmentationNoHeader',\r\n  activeViewportWindowLevel: '@ohif/extension-cornerstone.panelModule.activeViewportWindowLevel',\r\n};\r\n\r\nfunction getDefaultButtons({ toolbarService }) {\r\n  return [\r\n    {\r\n      buttonSection: toolbarService.sections.primary,\r\n      buttons: ['MeasurementTools', 'Zoom', 'WindowLevel', 'Crosshairs', 'Pan'],\r\n    },\r\n    {\r\n      buttonSection: 'MeasurementTools',\r\n      buttons: ['Length', 'Bidirectional', 'ArrowAnnotate', 'EllipticalROI'],\r\n    },\r\n  ];\r\n}\r\n\r\nfunction getROIThresholdToolbox({ toolbarService }) {\r\n  return [\r\n    {\r\n      buttonSection: toolbarService.sections.dynamicToolbox,\r\n      buttons: ['SegmentationTools'],\r\n    },\r\n    {\r\n      buttonSection: 'SegmentationTools',\r\n      buttons: ['BrushTools', 'RectangleROIStartEndThreshold'],\r\n    },\r\n    {\r\n      buttonSection: 'BrushTools',\r\n      buttons: ['Brush', 'Eraser', 'Threshold'],\r\n    },\r\n  ];\r\n}\r\n\r\nconst defaultLeftPanel = [[dynamicVolume.leftPanel, cornerstone.activeViewportWindowLevel]];\r\n\r\nconst defaultLayout = {\r\n  panels: {\r\n    left: defaultLeftPanel,\r\n    right: [],\r\n  },\r\n};\r\n\r\nfunction getWorkflowSettings({ servicesManager }) {\r\n  const { toolbarService } = servicesManager.services;\r\n  const defaultButtons = getDefaultButtons({ toolbarService });\r\n  const ROIThresholdToolbox = getROIThresholdToolbox({ toolbarService });\r\n\r\n  return {\r\n    steps: [\r\n      {\r\n        id: 'dataPreparation',\r\n        name: 'Data Preparation',\r\n        layout: {\r\n          panels: {\r\n            left: defaultLeftPanel,\r\n          },\r\n        },\r\n        toolbarButtons: defaultButtons,\r\n        hangingProtocol: {\r\n          protocolId: 'default4D',\r\n          stageId: 'dataPreparation',\r\n        },\r\n        info: 'In the Data Preparation step, you can visualize the dynamic PT volume data in three orthogonal views: axial, sagittal, and coronal. Use the left panel controls to adjust the visualization settings, such as playback speed, or navigate between different frames. This step allows you to assess the quality of the PT data and prepare for further analysis or registration with other modalities.',\r\n      },\r\n      {\r\n        id: 'registration',\r\n        name: 'Registration',\r\n        layout: defaultLayout,\r\n        toolbarButtons: defaultButtons,\r\n        hangingProtocol: {\r\n          protocolId: 'default4D',\r\n          stageId: 'registration',\r\n        },\r\n        info: 'The Registration step provides a comprehensive view of the CT, PT, and fused CT-PT volume data in multiple orientations. The fusion viewports display the CT and PT volumes overlaid, allowing you to visually assess the alignment and registration between the two modalities. The individual CT and PT viewports are also available for side-by-side comparison. This step is crucial for ensuring proper registration before proceeding with further analysis or quantification.',\r\n      },\r\n      {\r\n        id: 'roiQuantification',\r\n        name: 'ROI Quantification',\r\n        layout: {\r\n          panels: {\r\n            left: defaultLeftPanel,\r\n            right: [[dynamicVolume.segmentation]],\r\n          },\r\n          options: {\r\n            leftPanelClosed: false,\r\n            rightPanelClosed: false,\r\n          },\r\n        },\r\n        toolbarButtons: [...defaultButtons, ...ROIThresholdToolbox],\r\n        hangingProtocol: {\r\n          protocolId: 'default4D',\r\n          stageId: 'roiQuantification',\r\n        },\r\n        info: 'The ROI quantification step allows you to define regions of interest (ROIs) with labelmap segmentations, on the fused CT-PT volume data using the labelmap tools. The left panel provides controls for adjusting the dynamic volume visualization, while the right panel offers tools for segmentation, editing, and exporting the ROI data. This step enables you to quantify the uptake or other measures within the defined ROIs for further analysis.',\r\n      },\r\n      {\r\n        id: 'kineticAnalysis',\r\n        name: 'Kinetic Analysis',\r\n        layout: defaultLayout,\r\n        toolbarButtons: defaultButtons,\r\n        hangingProtocol: {\r\n          protocolId: 'default4D',\r\n          stageId: 'kineticAnalysis',\r\n        },\r\n        onEnter: [\r\n          {\r\n            commandName: 'updateSegmentationsChartDisplaySet',\r\n            options: { servicesManager },\r\n          },\r\n        ],\r\n        info: 'The Kinetic Analysis step provides a comprehensive view for visualizing and analyzing the dynamic data derived from the ROI segmentations. The fusion viewports display the combined CT-PT volume data, while a dedicated viewport shows a series chart representing the data over time. This step allows you to explore the temporal dynamics of the uptake or other kinetic measures within the defined regions of interest, enabling further quantitative analysis and modeling.',\r\n      },\r\n    ],\r\n  };\r\n}\r\n\r\nexport { getWorkflowSettings as default };\r\n","import packageJson from '../package.json';\r\n\r\nconst id = packageJson.name;\r\n\r\nexport { id };\r\n","import { id } from './id';\r\nimport initWorkflowSteps from './initWorkflowSteps';\r\nimport initToolGroups from './initToolGroups';\r\nimport toolbarButtons from './toolbarButtons';\r\n\r\nconst extensionDependencies = {\r\n  '@ohif/extension-default': '3.7.0-beta.76',\r\n  '@ohif/extension-cornerstone': '3.7.0-beta.76',\r\n  '@ohif/extension-cornerstone-dynamic-volume': '3.7.0-beta.76',\r\n  '@ohif/extension-cornerstone-dicom-seg': '3.7.0-beta.76',\r\n  '@ohif/extension-tmtv': '3.7.0-beta.76',\r\n};\r\n\r\nconst ohif = {\r\n  layout: '@ohif/extension-default.layoutTemplateModule.viewerLayout',\r\n  defaultSopClassHandler: '@ohif/extension-default.sopClassHandlerModule.stack',\r\n  chartSopClassHandler: '@ohif/extension-default.sopClassHandlerModule.chart',\r\n  hangingProtocol: '@ohif/extension-default.hangingProtocolModule.default',\r\n  leftPanel: '@ohif/extension-default.panelModule.seriesList',\r\n  chartViewport: '@ohif/extension-default.viewportModule.chartViewport',\r\n};\r\n\r\nconst dynamicVolume = {\r\n  leftPanel: '@ohif/extension-cornerstone-dynamic-volume.panelModule.dynamic-volume',\r\n};\r\n\r\nconst cornerstone = {\r\n  viewport: '@ohif/extension-cornerstone.viewportModule.cornerstone',\r\n  activeViewportWindowLevel: '@ohif/extension-cornerstone.panelModule.activeViewportWindowLevel',\r\n};\r\n\r\nfunction modeFactory({ modeConfiguration }) {\r\n  return {\r\n    id,\r\n    routeName: 'dynamic-volume',\r\n    displayName: 'Preclinical 4D',\r\n    onModeEnter: function ({ servicesManager, extensionManager, commandsManager }: withAppTypes) {\r\n      const {\r\n        measurementService,\r\n        toolbarService,\r\n        cineService,\r\n        cornerstoneViewportService,\r\n        toolGroupService,\r\n        customizationService,\r\n        viewportGridService,\r\n      } = servicesManager.services;\r\n\r\n      const utilityModule = extensionManager.getModuleEntry(\r\n        '@ohif/extension-cornerstone.utilityModule.tools'\r\n      );\r\n\r\n      const { toolNames, Enums } = utilityModule.exports;\r\n\r\n      measurementService.clearMeasurements();\r\n      initToolGroups({ toolNames, Enums, toolGroupService, commandsManager, servicesManager });\r\n\r\n      toolbarService.register(toolbarButtons);\r\n\r\n      toolbarService.updateSection(toolbarService.sections.secondary, ['ProgressDropdown']);\r\n\r\n      toolbarService.updateSection(toolbarService.sections.viewportActionMenu.topLeft, [\r\n        'orientationMenu',\r\n        'dataOverlayMenu',\r\n      ]);\r\n\r\n      toolbarService.updateSection(toolbarService.sections.viewportActionMenu.topLeft, [\r\n        'orientationMenu',\r\n        'dataOverlayMenu',\r\n      ]);\r\n\r\n      toolbarService.updateSection(toolbarService.sections.viewportActionMenu.bottomMiddle, [\r\n        'AdvancedRenderingControls',\r\n      ]);\r\n\r\n      toolbarService.updateSection('AdvancedRenderingControls', [\r\n        'windowLevelMenuEmbedded',\r\n        'voiManualControlMenu',\r\n        'Colorbar',\r\n        'opacityMenu',\r\n        'thresholdMenu',\r\n      ]);\r\n\r\n      toolbarService.updateSection(toolbarService.sections.viewportActionMenu.topRight, [\r\n        'modalityLoadBadge',\r\n        'trackingStatus',\r\n        'navigationComponent',\r\n      ]);\r\n\r\n      toolbarService.updateSection(toolbarService.sections.viewportActionMenu.bottomLeft, [\r\n        'windowLevelMenu',\r\n      ]);\r\n\r\n      // the primary button section is created in the workflow steps\r\n      // specific to the step\r\n      customizationService.setCustomizations({\r\n        'panelSegmentation.tableMode': {\r\n          $set: 'expanded',\r\n        },\r\n        'panelSegmentation.onSegmentationAdd': {\r\n          $set: () => {\r\n            commandsManager.run('createNewLabelMapForDynamicVolume');\r\n          },\r\n        },\r\n        'panelSegmentation.showAddSegment': {\r\n          $set: false,\r\n        },\r\n      });\r\n\r\n      // Auto play the clip initially when the volumes are loaded\r\n      const { unsubscribe } = cornerstoneViewportService.subscribe(\r\n        cornerstoneViewportService.EVENTS.VIEWPORT_VOLUMES_CHANGED,\r\n        () => {\r\n          const viewportId = viewportGridService.getActiveViewportId();\r\n          const csViewport = cornerstoneViewportService.getCornerstoneViewport(viewportId);\r\n          cineService.playClip(csViewport.element, { viewportId });\r\n          // cineService.setIsCineEnabled(true);\r\n\r\n          unsubscribe();\r\n        }\r\n      );\r\n    },\r\n    onSetupRouteComplete: ({ servicesManager }: withAppTypes) => {\r\n      // This needs to run after hanging protocol matching process because\r\n      // it may change the protocol/stage based on workflow stage settings\r\n      initWorkflowSteps({ servicesManager });\r\n    },\r\n    onModeExit: ({ servicesManager }: withAppTypes) => {\r\n      const {\r\n        toolGroupService,\r\n        syncGroupService,\r\n        segmentationService,\r\n        cornerstoneViewportService,\r\n      } = servicesManager.services;\r\n\r\n      toolGroupService.destroy();\r\n      syncGroupService.destroy();\r\n      segmentationService.destroy();\r\n      cornerstoneViewportService.destroy();\r\n    },\r\n    get validationTags() {\r\n      return {\r\n        study: [],\r\n        series: [],\r\n      };\r\n    },\r\n    isValidMode: ({ modalities, study }) => {\r\n      // Todo: we need to find a better way to validate the mode\r\n      return {\r\n        valid: study.mrn === 'M1',\r\n        description: 'This mode is only available for 4D PET/CT studies.',\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Mode Routes are used to define the mode's behavior. A list of Mode Route\r\n     * that includes the mode's path and the layout to be used. The layout will\r\n     * include the components that are used in the layout. For instance, if the\r\n     * default layoutTemplate is used (id: '@ohif/extension-default.layoutTemplateModule.viewerLayout')\r\n     * it will include the leftPanels, rightPanels, and viewports. However, if\r\n     * you define another layoutTemplate that includes a Footer for instance,\r\n     * you should provide the Footer component here too. Note: We use Strings\r\n     * to reference the component's ID as they are registered in the internal\r\n     * ExtensionManager. The template for the string is:\r\n     * `${extensionId}.{moduleType}.${componentId}`.\r\n     */\r\n    routes: [\r\n      {\r\n        path: 'preclinical-4d',\r\n        layoutTemplate: ({ location, servicesManager }) => {\r\n          return {\r\n            id: ohif.layout,\r\n            props: {\r\n              leftPanels: [[dynamicVolume.leftPanel, cornerstone.activeViewportWindowLevel]],\r\n              leftPanelResizable: true,\r\n              rightPanels: [],\r\n              rightPanelResizable: true,\r\n              rightPanelClosed: true,\r\n              viewports: [\r\n                {\r\n                  namespace: cornerstone.viewport,\r\n                  displaySetsToDisplay: [ohif.defaultSopClassHandler],\r\n                },\r\n                {\r\n                  namespace: ohif.chartViewport,\r\n                  displaySetsToDisplay: [ohif.chartSopClassHandler],\r\n                },\r\n              ],\r\n            },\r\n          };\r\n        },\r\n      },\r\n    ],\r\n    extensions: extensionDependencies,\r\n    // Default protocol gets self-registered by default in the init\r\n    hangingProtocol: 'default4D',\r\n    // Order is important in sop class handlers when two handlers both use\r\n    // the same sop class under different situations.  In that case, the more\r\n    // general handler needs to come last.  For this case, the dicomvideo must\r\n    // come first to remove video transfer syntax before ohif uses images\r\n    sopClassHandlers: [ohif.chartSopClassHandler, ohif.defaultSopClassHandler],\r\n  };\r\n}\r\n\r\nconst mode = {\r\n  id,\r\n  modeFactory,\r\n  extensionDependencies,\r\n};\r\n\r\nexport default mode;\r\n","const toolGroupIds = {\r\n  default: 'dynamic4D-default',\r\n  PT: 'dynamic4D-pt',\r\n  Fusion: 'dynamic4D-fusion',\r\n  CT: 'dynamic4D-ct',\r\n};\r\n\r\nconst colours = {\r\n  'viewport-0': 'rgb(200, 0, 0)',\r\n  'viewport-1': 'rgb(200, 200, 0)',\r\n  'viewport-2': 'rgb(0, 200, 0)',\r\n};\r\n\r\nconst colorsByOrientation = {\r\n  axial: 'rgb(200, 0, 0)',\r\n  sagittal: 'rgb(200, 200, 0)',\r\n  coronal: 'rgb(0, 200, 0)',\r\n};\r\n\r\nfunction _initToolGroups(toolNames, Enums, toolGroupService, commandsManager, servicesManager) {\r\n  const { cornerstoneViewportService } = servicesManager.services;\r\n  const tools = {\r\n    active: [\r\n      {\r\n        toolName: toolNames.WindowLevel,\r\n        bindings: [{ mouseButton: Enums.MouseBindings.Primary }],\r\n      },\r\n      {\r\n        toolName: toolNames.Pan,\r\n        bindings: [{ mouseButton: Enums.MouseBindings.Auxiliary }],\r\n      },\r\n      {\r\n        toolName: toolNames.Zoom,\r\n        bindings: [{ mouseButton: Enums.MouseBindings.Secondary }, { numTouchPoints: 2 }],\r\n      },\r\n      {\r\n        toolName: toolNames.StackScroll,\r\n        bindings: [{ mouseButton: Enums.MouseBindings.Wheel }, { numTouchPoints: 3 }],\r\n      },\r\n    ],\r\n    passive: [\r\n      { toolName: toolNames.Length },\r\n      { toolName: toolNames.SegmentBidirectional },\r\n      { toolName: toolNames.ArrowAnnotate },\r\n      { toolName: toolNames.Bidirectional },\r\n      { toolName: toolNames.Probe },\r\n      { toolName: toolNames.EllipticalROI },\r\n      { toolName: toolNames.RectangleROI },\r\n      { toolName: toolNames.RectangleROIThreshold },\r\n      { toolName: toolNames.RectangleScissors },\r\n      { toolName: toolNames.PaintFill },\r\n      { toolName: toolNames.StackScroll },\r\n      { toolName: toolNames.Magnify },\r\n      {\r\n        toolName: 'CircularBrush',\r\n        parentTool: 'Brush',\r\n        configuration: {\r\n          activeStrategy: 'FILL_INSIDE_CIRCLE',\r\n          brushSize: 7,\r\n        },\r\n      },\r\n      {\r\n        toolName: 'CircularEraser',\r\n        parentTool: 'Brush',\r\n        configuration: {\r\n          activeStrategy: 'ERASE_INSIDE_CIRCLE',\r\n          brushSize: 7,\r\n        },\r\n      },\r\n      {\r\n        toolName: 'SphereBrush',\r\n        parentTool: 'Brush',\r\n        configuration: {\r\n          activeStrategy: 'FILL_INSIDE_SPHERE',\r\n          brushSize: 7,\r\n        },\r\n      },\r\n      {\r\n        toolName: 'SphereEraser',\r\n        parentTool: 'Brush',\r\n        configuration: {\r\n          activeStrategy: 'ERASE_INSIDE_SPHERE',\r\n          brushSize: 7,\r\n        },\r\n      },\r\n      {\r\n        toolName: 'ThresholdCircularBrush',\r\n        parentTool: 'Brush',\r\n        configuration: {\r\n          activeStrategy: 'THRESHOLD_INSIDE_CIRCLE',\r\n          brushSize: 7,\r\n        },\r\n      },\r\n      {\r\n        toolName: 'ThresholdSphereBrush',\r\n        parentTool: 'Brush',\r\n        configuration: {\r\n          activeStrategy: 'THRESHOLD_INSIDE_SPHERE',\r\n          brushSize: 7,\r\n        },\r\n      },\r\n      { toolName: toolNames.CircleScissors },\r\n      { toolName: toolNames.RectangleScissors },\r\n      { toolName: toolNames.SphereScissors },\r\n      { toolName: toolNames.StackScroll },\r\n      { toolName: toolNames.Magnify },\r\n    ],\r\n    enabled: [],\r\n    disabled: [\r\n      {\r\n        toolName: toolNames.Crosshairs,\r\n        configuration: {\r\n          viewportIndicators: true,\r\n          viewportIndicatorsConfig: {\r\n            circleRadius: 5,\r\n            xOffset: 0.95,\r\n            yOffset: 0.05,\r\n          },\r\n          disableOnPassive: true,\r\n          autoPan: {\r\n            enabled: false,\r\n            panSize: 10,\r\n          },\r\n          getReferenceLineColor: viewportId => {\r\n            const viewportInfo = cornerstoneViewportService.getViewportInfo(viewportId);\r\n            const viewportOptions = viewportInfo?.viewportOptions;\r\n            if (viewportOptions) {\r\n              return (\r\n                colours[viewportOptions.id] ||\r\n                colorsByOrientation[viewportOptions.orientation] ||\r\n                '#0c0'\r\n              );\r\n            } else {\r\n              console.warn('missing viewport?', viewportId);\r\n              return '#0c0';\r\n            }\r\n          },\r\n        },\r\n      },\r\n    ],\r\n  };\r\n\r\n  toolGroupService.createToolGroupAndAddTools(toolGroupIds.PT, {\r\n    ...tools,\r\n    passive: [...tools.passive, { toolName: 'RectangleROIStartEndThreshold' }],\r\n  });\r\n\r\n  toolGroupService.createToolGroupAndAddTools(toolGroupIds.CT, {\r\n    ...tools,\r\n    passive: [...tools.passive, { toolName: 'RectangleROIStartEndThreshold' }],\r\n  });\r\n\r\n  toolGroupService.createToolGroupAndAddTools(toolGroupIds.Fusion, {\r\n    ...tools,\r\n    passive: [...tools.passive, { toolName: 'RectangleROIStartEndThreshold' }],\r\n  });\r\n\r\n  toolGroupService.createToolGroupAndAddTools(toolGroupIds.default, tools);\r\n}\r\n\r\nfunction initToolGroups({ toolNames, Enums, toolGroupService, commandsManager, servicesManager }) {\r\n  _initToolGroups(toolNames, Enums, toolGroupService, commandsManager, servicesManager);\r\n}\r\n\r\nexport { initToolGroups as default, toolGroupIds };\r\n","import getWorkflowSettings from './getWorkflowSettings';\r\n\r\nexport default function initWorkflowSteps({ servicesManager }: withAppTypes): void {\r\n  const { workflowStepsService } = servicesManager.services;\r\n  const workflowSettings = getWorkflowSettings({ servicesManager });\r\n\r\n  workflowStepsService.addWorkflowSteps(workflowSettings.steps);\r\n  workflowStepsService.setActiveWorkflowStep(workflowSettings.steps[0].id);\r\n}\r\n","import { toolGroupIds } from './initToolGroups';\r\nimport { ViewportGridService } from '@ohif/core';\r\n\r\nconst setToolActiveToolbar = {\r\n  commandName: 'setToolActiveToolbar',\r\n  commandOptions: {\r\n    toolGroupIds: [toolGroupIds.PT, toolGroupIds.CT, toolGroupIds.Fusion, toolGroupIds.default],\r\n  },\r\n};\r\n\r\nconst callbacks = (toolName: string) => [\r\n  {\r\n    commandName: 'setViewportForToolConfiguration',\r\n    commandOptions: {\r\n      toolName,\r\n    },\r\n  },\r\n];\r\n\r\nconst toolbarButtons = [\r\n  {\r\n    id: 'MeasurementTools',\r\n    uiType: 'ohif.toolButtonList',\r\n    props: {\r\n      buttonSection: true,\r\n    },\r\n  },\r\n  {\r\n    id: 'BrushTools',\r\n    uiType: 'ohif.toolBoxButtonGroup',\r\n    props: {\r\n      buttonSection: true,\r\n    },\r\n  },\r\n  {\r\n    id: 'SegmentationTools',\r\n    uiType: 'ohif.toolBoxButton',\r\n    props: {\r\n      buttonSection: true,\r\n    },\r\n  },\r\n  {\r\n    id: 'AdvancedRenderingControls',\r\n    uiType: 'ohif.advancedRenderingControls',\r\n    props: {\r\n      buttonSection: true,\r\n    },\r\n  },\r\n  {\r\n    id: 'modalityLoadBadge',\r\n    uiType: 'ohif.modalityLoadBadge',\r\n    props: {\r\n      icon: 'Status',\r\n      label: 'Status',\r\n      tooltip: 'Status',\r\n      evaluate: {\r\n        name: 'evaluate.modalityLoadBadge',\r\n        hideWhenDisabled: true,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    id: 'navigationComponent',\r\n    uiType: 'ohif.navigationComponent',\r\n    props: {\r\n      icon: 'Navigation',\r\n      label: 'Navigation',\r\n      tooltip: 'Navigate between segments/measurements and manage their visibility',\r\n      evaluate: {\r\n        name: 'evaluate.navigationComponent',\r\n        hideWhenDisabled: true,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    id: 'windowLevelMenuEmbedded',\r\n    uiType: 'ohif.windowLevelMenuEmbedded',\r\n    props: {\r\n      icon: 'WindowLevel',\r\n      label: 'Window Level',\r\n      tooltip: 'Adjust window/level presets and customize image contrast settings',\r\n      evaluate: {\r\n        name: 'evaluate.windowLevelMenuEmbedded',\r\n        hideWhenDisabled: true,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    id: 'trackingStatus',\r\n    uiType: 'ohif.trackingStatus',\r\n    props: {\r\n      icon: 'TrackingStatus',\r\n      label: 'Tracking Status',\r\n      tooltip: 'View and manage tracking status of measurements and annotations',\r\n      evaluate: {\r\n        name: 'evaluate.trackingStatus',\r\n        hideWhenDisabled: true,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    id: 'Length',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'tool-length',\r\n      label: 'Length',\r\n      tooltip: 'Length Tool',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: 'evaluate.cornerstoneTool',\r\n    },\r\n  },\r\n  {\r\n    id: 'Bidirectional',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'tool-bidirectional',\r\n      label: 'Bidirectional',\r\n      tooltip: 'Bidirectional Tool',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: 'evaluate.cornerstoneTool',\r\n    },\r\n  },\r\n  {\r\n    id: 'ArrowAnnotate',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'tool-annotate',\r\n      label: 'Annotation',\r\n      tooltip: 'Arrow Annotate',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: 'evaluate.cornerstoneTool',\r\n    },\r\n  },\r\n  {\r\n    id: 'EllipticalROI',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'tool-ellipse',\r\n      label: 'Ellipse',\r\n      tooltip: 'Ellipse ROI',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: 'evaluate.cornerstoneTool',\r\n    },\r\n  },\r\n  {\r\n    id: 'Zoom',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'tool-zoom',\r\n      label: 'Zoom',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: 'evaluate.cornerstoneTool',\r\n    },\r\n  },\r\n  {\r\n    id: 'WindowLevel',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'tool-window-level',\r\n      label: 'Window Level',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: 'evaluate.cornerstoneTool',\r\n    },\r\n  },\r\n  {\r\n    id: 'Pan',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      type: 'tool',\r\n      icon: 'tool-move',\r\n      label: 'Pan',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: 'evaluate.cornerstoneTool',\r\n    },\r\n  },\r\n  {\r\n    id: 'TrackballRotate',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      type: 'tool',\r\n      icon: 'tool-3d-rotate',\r\n      label: '3D Rotate',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: 'evaluate.cornerstoneTool',\r\n    },\r\n  },\r\n  {\r\n    id: 'Capture',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'tool-capture',\r\n      label: 'Capture',\r\n      commands: 'showDownloadViewportModal',\r\n      evaluate: [\r\n        'evaluate.action',\r\n        {\r\n          name: 'evaluate.viewport.supported',\r\n          unsupportedViewportTypes: ['video', 'wholeSlide'],\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    id: 'Layout',\r\n    uiType: 'ohif.layoutSelector',\r\n    props: {\r\n      rows: 3,\r\n      columns: 4,\r\n      evaluate: 'evaluate.action',\r\n      commands: 'setViewportGridLayout',\r\n    },\r\n  },\r\n  {\r\n    id: 'Crosshairs',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      type: 'tool',\r\n      icon: 'tool-crosshair',\r\n      label: 'Crosshairs',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: 'evaluate.cornerstoneTool',\r\n    },\r\n  },\r\n  {\r\n    id: 'ProgressDropdown',\r\n    uiType: 'ohif.progressDropdown',\r\n  },\r\n  {\r\n    id: 'RectangleROIStartEndThreshold',\r\n    uiType: 'ohif.toolBoxButton',\r\n    props: {\r\n      icon: 'tool-create-threshold',\r\n      label: 'Rectangle ROI Threshold',\r\n      commands: setToolActiveToolbar,\r\n      evaluate: {\r\n        name: 'evaluate.cornerstone.segmentation',\r\n        toolNames: ['RectangleROIStartEndThreshold'],\r\n      },\r\n      options: 'tmtv.RectangleROIThresholdOptions',\r\n    },\r\n  },\r\n  {\r\n    id: 'Brush',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'icon-tool-brush',\r\n      label: 'Brush',\r\n      evaluate: {\r\n        name: 'evaluate.cornerstone.segmentation',\r\n        toolNames: ['CircularBrush', 'SphereBrush'],\r\n      },\r\n      options: [\r\n        {\r\n          name: 'Size (mm)',\r\n          id: 'brush-radius',\r\n          type: 'range',\r\n          min: 0.5,\r\n          max: 99.5,\r\n          step: 0.5,\r\n          value: 7,\r\n          commands: {\r\n            commandName: 'setBrushSize',\r\n            commandOptions: { toolNames: ['CircularBrush', 'SphereBrush'] },\r\n          },\r\n        },\r\n        {\r\n          name: 'Shape',\r\n          type: 'radio',\r\n          id: 'brush-mode',\r\n          value: 'CircularBrush',\r\n          values: [\r\n            { value: 'CircularBrush', label: 'Circle' },\r\n            { value: 'SphereBrush', label: 'Sphere' },\r\n          ],\r\n          commands: 'setToolActiveToolbar',\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    id: 'Eraser',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'icon-tool-eraser',\r\n      label: 'Eraser',\r\n      evaluate: {\r\n        name: 'evaluate.cornerstone.segmentation',\r\n        toolNames: ['CircularEraser', 'SphereEraser'],\r\n      },\r\n      options: [\r\n        {\r\n          name: 'Radius (mm)',\r\n          id: 'eraser-radius',\r\n          type: 'range',\r\n          min: 0.5,\r\n          max: 99.5,\r\n          step: 0.5,\r\n          value: 7,\r\n          commands: {\r\n            commandName: 'setBrushSize',\r\n            commandOptions: { toolNames: ['CircularEraser', 'SphereEraser'] },\r\n          },\r\n        },\r\n        {\r\n          name: 'Shape',\r\n          type: 'radio',\r\n          id: 'eraser-mode',\r\n          value: 'CircularEraser',\r\n          values: [\r\n            { value: 'CircularEraser', label: 'Circle' },\r\n            { value: 'SphereEraser', label: 'Sphere' },\r\n          ],\r\n          commands: 'setToolActiveToolbar',\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    id: 'Threshold',\r\n    uiType: 'ohif.toolButton',\r\n    props: {\r\n      icon: 'icon-tool-threshold',\r\n      label: 'Threshold',\r\n      evaluate: {\r\n        name: 'evaluate.cornerstone.segmentation',\r\n        toolNames: ['ThresholdCircularBrush', 'ThresholdSphereBrush'],\r\n      },\r\n      options: [\r\n        {\r\n          name: 'Radius (mm)',\r\n          id: 'threshold-radius',\r\n          type: 'range',\r\n          min: 0.5,\r\n          max: 99.5,\r\n          step: 0.5,\r\n          value: 7,\r\n          commands: {\r\n            commandName: 'setBrushSize',\r\n            commandOptions: {\r\n              toolNames: ['ThresholdCircularBrush', 'ThresholdSphereBrush'],\r\n            },\r\n          },\r\n        },\r\n        {\r\n          name: 'Shape',\r\n          type: 'radio',\r\n          id: 'eraser-mode',\r\n          value: 'ThresholdCircularBrush',\r\n          values: [\r\n            { value: 'ThresholdCircularBrush', label: 'Circle' },\r\n            { value: 'ThresholdSphereBrush', label: 'Sphere' },\r\n          ],\r\n          commands: 'setToolActiveToolbar',\r\n        },\r\n        {\r\n          name: 'ThresholdRange',\r\n          type: 'double-range',\r\n          id: 'threshold-range',\r\n          min: 0,\r\n          max: 100,\r\n          step: 0.5,\r\n          value: [2, 50],\r\n          commands: {\r\n            commandName: 'setThresholdRange',\r\n            commandOptions: {\r\n              toolNames: ['ThresholdCircularBrush', 'ThresholdSphereBrush'],\r\n            },\r\n          },\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    id: 'Shapes',\r\n    uiType: 'ohif.toolBoxButton',\r\n    props: {\r\n      label: 'Shapes',\r\n      evaluate: {\r\n        name: 'evaluate.cornerstone.segmentation',\r\n        toolNames: ['CircleScissor', 'SphereScissor', 'RectangleScissor'],\r\n      },\r\n      icon: 'icon-tool-shape',\r\n      options: [\r\n        {\r\n          name: 'Shape',\r\n          type: 'radio',\r\n          value: 'CircleScissor',\r\n          id: 'shape-mode',\r\n          values: [\r\n            { value: 'CircleScissor', label: 'Circle' },\r\n            { value: 'SphereScissor', label: 'Sphere' },\r\n            { value: 'RectangleScissor', label: 'Rectangle' },\r\n          ],\r\n          commands: 'setToolActiveToolbar',\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    id: 'dataOverlayMenu',\r\n    uiType: 'ohif.dataOverlayMenu',\r\n    props: {\r\n      icon: 'ViewportViews',\r\n      label: 'Data Overlay',\r\n      tooltip: 'Configure data overlay options and manage foreground/background display sets',\r\n      evaluate: 'evaluate.dataOverlayMenu',\r\n    },\r\n  },\r\n  {\r\n    id: 'orientationMenu',\r\n    uiType: 'ohif.orientationMenu',\r\n    props: {\r\n      icon: 'OrientationSwitch',\r\n      label: 'Orientation',\r\n      tooltip:\r\n        'Change viewport orientation between axial, sagittal, coronal and acquisition planes',\r\n      evaluate: {\r\n        name: 'evaluate.orientationMenu',\r\n        // hideWhenDisabled: true,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    id: 'windowLevelMenu',\r\n    uiType: 'ohif.windowLevelMenu',\r\n    props: {\r\n      icon: 'WindowLevel',\r\n      label: 'Window Level',\r\n      tooltip: 'Adjust window/level presets and customize image contrast settings',\r\n      evaluate: 'evaluate.windowLevelMenu',\r\n    },\r\n  },\r\n  {\r\n    id: 'voiManualControlMenu',\r\n    uiType: 'ohif.voiManualControlMenu',\r\n    props: {\r\n      icon: 'WindowLevelAdvanced',\r\n      label: 'Advanced Window Level',\r\n      tooltip: 'Advanced window/level settings with manual controls and presets',\r\n      evaluate: 'evaluate.voiManualControlMenu',\r\n    },\r\n  },\r\n  {\r\n    id: 'thresholdMenu',\r\n    uiType: 'ohif.thresholdMenu',\r\n    props: {\r\n      icon: 'Threshold',\r\n      label: 'Threshold',\r\n      tooltip: 'Image threshold settings',\r\n      evaluate: {\r\n        name: 'evaluate.thresholdMenu',\r\n        hideWhenDisabled: true,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    id: 'opacityMenu',\r\n    uiType: 'ohif.opacityMenu',\r\n    props: {\r\n      icon: 'Opacity',\r\n      label: 'Opacity',\r\n      tooltip: 'Image opacity settings',\r\n      evaluate: {\r\n        name: 'evaluate.opacityMenu',\r\n        hideWhenDisabled: true,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    id: 'Colorbar',\r\n    uiType: 'ohif.colorbar',\r\n    props: {\r\n      type: 'tool',\r\n      label: 'Colorbar',\r\n    },\r\n  },\r\n];\r\n\r\nexport default toolbarButtons;\r\n"],"names":[],"sourceRoot":""}